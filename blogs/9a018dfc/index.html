<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>机器学习系统环境配置指南 —— GTX 1080 + Ubuntu16.04 + CUDA8 + cuDNN5.1 + TensorFlow | Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="最近开始学习机器学习，所以需要配一台电脑。本文主要写的是系统环境配置的内容，依据前人经验总结自己的安装过程，希望可以给大家一个参考。
主机配置：i7-6700 + 24G内存 + GTX 1080
系统环境配置：

Ubuntu 16.04 LTS 64位
CUDA 8.0
cuDNN v5.1
TensorFlow v0.12.0 RC1
Python 2.7
Bazel 0.4.2

在整个环">
<meta property="og:type" content="article">
<meta property="og:title" content="机器学习系统环境配置指南 —— GTX 1080 + Ubuntu16.04 + CUDA8 + cuDNN5.1 + TensorFlow">
<meta property="og:url" content="https://bluesmilery.github.io/blogs/9a018dfc/index.html">
<meta property="og:site_name" content="Blog">
<meta property="og:description" content="最近开始学习机器学习，所以需要配一台电脑。本文主要写的是系统环境配置的内容，依据前人经验总结自己的安装过程，希望可以给大家一个参考。
主机配置：i7-6700 + 24G内存 + GTX 1080
系统环境配置：

Ubuntu 16.04 LTS 64位
CUDA 8.0
cuDNN v5.1
TensorFlow v0.12.0 RC1
Python 2.7
Bazel 0.4.2

在整个环">
<meta property="og:image" content="https://bluesmilery.github.io/images/2017-03-15-机器学习系统环境配置指南——GTX 1080+Ubuntu16.04+CUDA8+cuDNN5.1+TensorFlow/14895833560005.png">
<meta property="og:image" content="https://bluesmilery.github.io/images/2017-03-15-机器学习系统环境配置指南——GTX 1080+Ubuntu16.04+CUDA8+cuDNN5.1+TensorFlow/14895840227754.png">
<meta property="og:image" content="https://bluesmilery.github.io/images/2017-03-15-机器学习系统环境配置指南——GTX 1080+Ubuntu16.04+CUDA8+cuDNN5.1+TensorFlow/14895848606250.png">
<meta property="og:updated_time" content="2017-03-20T02:41:40.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="机器学习系统环境配置指南 —— GTX 1080 + Ubuntu16.04 + CUDA8 + cuDNN5.1 + TensorFlow">
<meta name="twitter:description" content="最近开始学习机器学习，所以需要配一台电脑。本文主要写的是系统环境配置的内容，依据前人经验总结自己的安装过程，希望可以给大家一个参考。
主机配置：i7-6700 + 24G内存 + GTX 1080
系统环境配置：

Ubuntu 16.04 LTS 64位
CUDA 8.0
cuDNN v5.1
TensorFlow v0.12.0 RC1
Python 2.7
Bazel 0.4.2

在整个环">
<meta name="twitter:image" content="https://bluesmilery.github.io/images/2017-03-15-机器学习系统环境配置指南——GTX 1080+Ubuntu16.04+CUDA8+cuDNN5.1+TensorFlow/14895833560005.png">
  
    <link rel="alternate" href="/atom.xml" title="Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">A Zone for Knowledge</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="Flux RSS"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Rechercher"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://bluesmilery.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-机器学习系统环境配置指南——GTX 1080+Ubuntu16.04+CUDA8+cuDNN5.1+TensorFlow" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blogs/9a018dfc/" class="article-date">
  <time datetime="2017-03-15T12:51:45.000Z" itemprop="datePublished">2017-03-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      机器学习系统环境配置指南 —— GTX 1080 + Ubuntu16.04 + CUDA8 + cuDNN5.1 + TensorFlow
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>最近开始学习机器学习，所以需要配一台电脑。本文主要写的是系统环境配置的内容，依据前人经验总结自己的安装过程，希望可以给大家一个参考。</p>
<p>主机配置：i7-6700 + 24G内存 + GTX 1080</p>
<p>系统环境配置：</p>
<ul>
<li>Ubuntu 16.04 LTS 64位</li>
<li>CUDA 8.0</li>
<li>cuDNN v5.1</li>
<li>TensorFlow v0.12.0 RC1</li>
<li>Python 2.7</li>
<li>Bazel 0.4.2</li>
</ul>
<p>在整个环境配置过程中，有许多东西可以提前下载好，在配置时便可以节省时间了。<br><a href="https://developer.nvidia.com/cuda-downloads" target="_blank" rel="external">CUDA 8.0</a> (1.4GB)：Linux &gt; x86_64 &gt; Ubuntu &gt; 16.04 &gt; runfile(local)<br><a href="https://developer.nvidia.com/rdp/cudnn-download" target="_blank" rel="external">cuDNN v5.1</a> (100MB)： 需要注册Nvidia开发者账号，Download cuDNN v5.1 (August 10, 2016), for CUDA 8.0 &gt; cuDNN v5.1 Library for Linux。最好在Linux系统下下载，格式为.tgz。在Windows下下载的格式会识别成.solitairetheme8格式。<br><a href="https://github.com/tensorflow/tensorflow/releases" target="_blank" rel="external">TensorFlow 源码release版</a> (10MB+)：下载v0.12.0 RC1，zip或者tar.gz均可<br><a href="https://github.com/tensorflow/tensorflow" target="_blank" rel="external">TensorFlow pip安装包</a> (CPU版40MB+，GPU版80MB+)：选择Linux和Python2的版本，CPU和GPU的都下。pip安装包只会下载最新版本<br><a href="https://github.com/bazelbuild/bazel/releases" target="_blank" rel="external">Bazel 源码</a> (100MB+)：下载0.4.2版本，选择bazel-0.4.2-installer-linux-x86_64.sh</p>
<a id="more"></a>
<h2 id="一、安装Nvidia显卡驱动（GTX-1080）"><a href="#一、安装Nvidia显卡驱动（GTX-1080）" class="headerlink" title="一、安装Nvidia显卡驱动（GTX 1080）"></a>一、安装Nvidia显卡驱动（GTX 1080）</h2><p>1、安装完Ubuntu16.04系统后，第一次进入系统分辨率很低，所以先简单修改一下分辨率。<br>打开terminal，执行：<code>sudo gedit /etc/default/grub</code><br>有一行内容是 #GRUB_GFXMODE=640x480，然后把#号去掉，后面的640x480改为1024x768。<br>然后执行：<code>sudo update-grub</code><br>重启电脑后，看起来比刚才舒服一些了</p>
<p>2、更新软件源，这里用的是中科大的源<br><code>cd /etc/apt/</code><br><code>sudo cp sources.list sources.list.bak</code><br><code>sudo gedit sources.list</code></p>
<p>把下面的内容添加到sources.list文件头部：</p>
<blockquote>
<p>deb <a href="http://mirrors.ustc.edu.cn/ubuntu/" target="_blank" rel="external">http://mirrors.ustc.edu.cn/ubuntu/</a> xenial main restricted universe multiverse<br>deb <a href="http://mirrors.ustc.edu.cn/ubuntu/" target="_blank" rel="external">http://mirrors.ustc.edu.cn/ubuntu/</a> xenial-security main restricted universe multiverse<br>deb <a href="http://mirrors.ustc.edu.cn/ubuntu/" target="_blank" rel="external">http://mirrors.ustc.edu.cn/ubuntu/</a> xenial-updates main restricted universe multiverse<br>deb <a href="http://mirrors.ustc.edu.cn/ubuntu/" target="_blank" rel="external">http://mirrors.ustc.edu.cn/ubuntu/</a> xenial-proposed main restricted universe multiverse<br>deb <a href="http://mirrors.ustc.edu.cn/ubuntu/" target="_blank" rel="external">http://mirrors.ustc.edu.cn/ubuntu/</a> xenial-backports main restricted universe multiverse<br>deb-src <a href="http://mirrors.ustc.edu.cn/ubuntu/" target="_blank" rel="external">http://mirrors.ustc.edu.cn/ubuntu/</a> xenial main restricted universe multiverse<br>deb-src <a href="http://mirrors.ustc.edu.cn/ubuntu/" target="_blank" rel="external">http://mirrors.ustc.edu.cn/ubuntu/</a> xenial-security main restricted universe multiverse<br>deb-src <a href="http://mirrors.ustc.edu.cn/ubuntu/" target="_blank" rel="external">http://mirrors.ustc.edu.cn/ubuntu/</a> xenial-updates main restricted universe multiverse<br>deb-src <a href="http://mirrors.ustc.edu.cn/ubuntu/" target="_blank" rel="external">http://mirrors.ustc.edu.cn/ubuntu/</a> xenial-proposed main restricted universe multiverse<br>deb-src <a href="http://mirrors.ustc.edu.cn/ubuntu/" target="_blank" rel="external">http://mirrors.ustc.edu.cn/ubuntu/</a> xenial-backports main restricted universe multiverse</p>
</blockquote>
<p>然后更新源和更新已安装的包<br><code>sudo apt-get update</code><br><code>sudo apt-get upgrade</code></p>
<p>3、安装Nvidia显卡驱动<br>先添加Ubuntu社区建立的Graphics Drivers PPA<br><code>sudo add-apt-repository ppa:graphics-drivers/ppa</code><br>出现一系列内容后，回车后继续<br><code>sudo apt-get update</code><br>此时，有两种方式可以安装驱动<br>1）第一种是进入System Settings &gt; Software&amp;Updates &gt; Additional Drivers，然后选择想安装的驱动，然后点apply，等待系统提醒重启系统即可</p>
<p>2）第二种是看一下软件源中有哪些Nvidia驱动<br><code>sudo apt-cache search nvidia</code><br>我选择安装最新的驱动版本375<br><code>sudo apt-get install nvidia-375</code><br>重启电脑后驱动生效<br>可以执行：<code>nvidia-smi</code>来查看信息，或者执行：<code>nvidia-settings</code>查看更详细的信息</p>
<h2 id="二、安装CUDA8-0"><a href="#二、安装CUDA8-0" class="headerlink" title="二、安装CUDA8.0"></a>二、安装CUDA8.0</h2><p>1、先去Nvidia开发者网站下载<a href="https://developer.nvidia.com/cuda-downloads" target="_blank" rel="external">CUDA8.0</a><br><img src="/images/2017-03-15-机器学习系统环境配置指南——GTX 1080+Ubuntu16.04+CUDA8+cuDNN5.1+TensorFlow/14895833560005.png" alt=""></p>
<p>下载好后，执行：<code>sudo sh cuda_8.0.44_linux.run</code>进行安装。如果出现了提示空间不足，那么执行：<code>sudo sh cuda_8.0.27_linux.run --tmpdir=/opt/temp/</code><br>执行后会有一系列提示需要确认，其中，询问是否安装Nvidia显卡驱动的时候选n，因为我们之前已经装过了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line">Do you accept the previously read EULA?</div><div class="line">accept/decline/quit:               accept</div><div class="line"></div><div class="line">Install NVIDIA Accelerated Graphics Driver for Linux-x86_64 367.48?</div><div class="line">(y)es/(n)o/(q)uit: n</div><div class="line"></div><div class="line">Install the CUDA 8.0 Toolkit?</div><div class="line">(y)es/(n)o/(q)uit: y</div><div class="line"></div><div class="line">Enter Toolkit Location</div><div class="line"> [ default is /usr/local/cuda-8.0 ]:</div><div class="line"></div><div class="line">Do you want to install a symbolic link at /usr/local/cuda?</div><div class="line">(y)es/(n)o/(q)uit: y</div><div class="line"></div><div class="line">Install the CUDA 8.0 Samples?</div><div class="line">(y)es/(n)o/(q)uit: y</div><div class="line"></div><div class="line">Enter CUDA Samples Location</div><div class="line"> [ default is /home/gai ]:</div><div class="line"></div><div class="line">Installing the CUDA Toolkit in /usr/local/cuda-8.0 ...</div><div class="line">Missing recommended library: libGLU.so</div><div class="line">Missing recommended library: libX11.so</div><div class="line">Missing recommended library: libXi.so</div><div class="line">Missing recommended library: libXmu.so</div><div class="line"></div><div class="line">Installing the CUDA Samples in /home/gai ...</div><div class="line">Copying samples to /home/gai/NVIDIA_CUDA-8.0_Samples now...</div><div class="line">Finished copying samples.</div><div class="line"></div><div class="line">===========</div><div class="line">= Summary =</div><div class="line">===========</div><div class="line"></div><div class="line">Driver:   Not Selected</div><div class="line">Toolkit:  Installed in /usr/local/cuda-8.0</div><div class="line">Samples:  Installed in /home/gai, but missing recommended libraries</div><div class="line"></div><div class="line">Please make sure that</div><div class="line"> -   PATH includes /usr/local/cuda-8.0/bin</div><div class="line"> -   LD_LIBRARY_PATH includes /usr/local/cuda-8.0/lib64, or, add /usr/local/cuda-8.0/lib64 to /etc/ld.so.conf and run ldconfig as root</div><div class="line"></div><div class="line">To uninstall the CUDA Toolkit, run the uninstall script in /usr/local/cuda-8.0/bin</div><div class="line"></div><div class="line">Please see CUDA_Installation_Guide_Linux.pdf in /usr/local/cuda-8.0/doc/pdf for detailed information on setting up CUDA.</div><div class="line"></div><div class="line">***WARNING: Incomplete installation! This installation did not install the CUDA Driver. A driver of version at least 361.00 is required for CUDA 8.0 functionality to work.</div><div class="line">To install the driver using this installer, run the following command, replacing &lt;CudaInstaller&gt; with the name of this run file:</div><div class="line">    sudo &lt;CudaInstaller&gt;.run -silent -driver</div><div class="line"></div><div class="line">Logfile is /tmp/cuda_install_6100.log</div></pre></td></tr></table></figure>
<p>可以发现系统提示缺少一些推荐安装的库：libGLU.so、libX11.so、libXi.so、libXmu.so<br>使用<a href="http://packages.ubuntu.com/" target="_blank" rel="external">Ubuntu Packages Search</a>进行搜索，在Search the contents of packages处分别键入以上四个库，可以发现需要安装以下软件包：libglu1-mesa-dev、libx11-dev、libxi-dev、libxmu-dev<br>所以执行：<code>sudo apt-get install libglu1-mesa-dev libx11-dev libxi-dev libxmu-dev</code><br>再参考下<a href="http://docs.nvidia.com/cuda/cuda-installation-guide-linux/#mandatory-post" target="_blank" rel="external">官方的安装指南</a>，发现还要配置环境变量，在home目录下执行：<code>sudo gedit .bashrc</code>，然后在文件末尾添加上下面两行内容</p>
<blockquote>
<p>export PATH=/usr/local/cuda-8.0/bin${PATH:+:${PATH}}<br>export LD_LIBRARY_PATH=/usr/local/cuda-8.0/lib64${LD_LIBRARY_PATH:+:${LD_LIBRARY_PATH}}</p>
</blockquote>
<p>然后执行：<code>source ~/.bashrc</code>更新一下</p>
<p>2、测试CUDA<br>测试几个官方CUDA的例子<br>在CUDA例子的1_Utilities/deviceQuery目录下执行：<code>make</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&quot;/usr/local/cuda-8.0&quot;/bin/nvcc -ccbin g++ -I../../common/inc  -m64    -gencode arch=compute_20,code=sm_20 -gencode arch=compute_30,code=sm_30 -gencode arch=compute_35,code=sm_35 -gencode arch=compute_37,code=sm_37 -gencode arch=compute_50,code=sm_50 -gencode arch=compute_52,code=sm_52 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_60,code=compute_60 -o deviceQuery.o -c deviceQuery.cpp</div><div class="line">nvcc warning : The &apos;compute_20&apos;, &apos;sm_20&apos;, and &apos;sm_21&apos; architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).</div><div class="line">&quot;/usr/local/cuda-8.0&quot;/bin/nvcc -ccbin g++   -m64      -gencode arch=compute_20,code=sm_20 -gencode arch=compute_30,code=sm_30 -gencode arch=compute_35,code=sm_35 -gencode arch=compute_37,code=sm_37 -gencode arch=compute_50,code=sm_50 -gencode arch=compute_52,code=sm_52 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_60,code=compute_60 -o deviceQuery deviceQuery.o</div><div class="line">nvcc warning : The &apos;compute_20&apos;, &apos;sm_20&apos;, and &apos;sm_21&apos; architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).</div><div class="line">mkdir -p ../../bin/x86_64/linux/release</div><div class="line">cp deviceQuery ../../bin/x86_64/linux/release</div></pre></td></tr></table></figure>
<p>编译完成，然后执行：<code>./deviceQuery</code>，会得到如下内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">./deviceQuery Starting...</div><div class="line"></div><div class="line"> CUDA Device Query (Runtime API) version (CUDART static linking)</div><div class="line"></div><div class="line">Detected 1 CUDA Capable device(s)</div><div class="line"></div><div class="line">Device 0: &quot;GeForce GTX 1080&quot;</div><div class="line">  CUDA Driver Version / Runtime Version          8.0 / 8.0</div><div class="line">  CUDA Capability Major/Minor version number:    6.1</div><div class="line">  Total amount of global memory:                 8110 MBytes (8504279040 bytes)</div><div class="line">  (20) Multiprocessors, (128) CUDA Cores/MP:     2560 CUDA Cores</div><div class="line">  GPU Max Clock rate:                            1810 MHz (1.81 GHz)</div><div class="line">  Memory Clock rate:                             5005 Mhz</div><div class="line">  Memory Bus Width:                              256-bit</div><div class="line">  L2 Cache Size:                                 2097152 bytes</div><div class="line">  Maximum Texture Dimension Size (x,y,z)         1D=(131072), 2D=(131072, 65536), 3D=(16384, 16384, 16384)</div><div class="line">  Maximum Layered 1D Texture Size, (num) layers  1D=(32768), 2048 layers</div><div class="line">  Maximum Layered 2D Texture Size, (num) layers  2D=(32768, 32768), 2048 layers</div><div class="line">  Total amount of constant memory:               65536 bytes</div><div class="line">  Total amount of shared memory per block:       49152 bytes</div><div class="line">  Total number of registers available per block: 65536</div><div class="line">  Warp size:                                     32</div><div class="line">  Maximum number of threads per multiprocessor:  2048</div><div class="line">  Maximum number of threads per block:           1024</div><div class="line">  Max dimension size of a thread block (x,y,z): (1024, 1024, 64)</div><div class="line">  Max dimension size of a grid size    (x,y,z): (2147483647, 65535, 65535)</div><div class="line">  Maximum memory pitch:                          2147483647 bytes</div><div class="line">  Texture alignment:                             512 bytes</div><div class="line">  Concurrent copy and kernel execution:          Yes with 2 copy engine(s)</div><div class="line">  Run time limit on kernels:                     Yes</div><div class="line">  Integrated GPU sharing Host Memory:            No</div><div class="line">  Support host page-locked memory mapping:       Yes</div><div class="line">  Alignment requirement for Surfaces:            Yes</div><div class="line">  Device has ECC support:                        Disabled</div><div class="line">  Device supports Unified Addressing (UVA):      Yes</div><div class="line">  Device PCI Domain ID / Bus ID / location ID:   0 / 1 / 0</div><div class="line">  Compute Mode:</div><div class="line">     &lt; Default (multiple host threads can use ::cudaSetDevice() with device simultaneously) &gt;</div><div class="line"></div><div class="line">deviceQuery, CUDA Driver = CUDART, CUDA Driver Version = 8.0, CUDA Runtime Version = 8.0, NumDevs = 1, Device0 = GeForce GTX 1080</div><div class="line">Result = PASS</div></pre></td></tr></table></figure>
<p>再测试另外一个例子，在5_Simulations/nbody目录下执行<code>make</code>，如果提示cannot find -lglut，那么需要执行下：<code>sudo apt-get install freeglut3-dev</code><br>编译完成后执行：<code>./nbody -benchmark -numbodies=256000 -device=0</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">Run &quot;nbody -benchmark [-numbodies=&lt;numBodies&gt;]&quot; to measure performance.</div><div class="line">    -fullscreen       (run n-body simulation in fullscreen mode)</div><div class="line">    -fp64             (use double precision floating point values for simulation)</div><div class="line">    -hostmem          (stores simulation data in host memory)</div><div class="line">    -benchmark        (run benchmark to measure performance)</div><div class="line">    -numbodies=&lt;N&gt;    (number of bodies (&gt;= 1) to run in simulation)</div><div class="line">    -device=&lt;d&gt;       (where d=0,1,2.... for the CUDA device to use)</div><div class="line">    -numdevices=&lt;i&gt;   (where i=(number of CUDA devices &gt; 0) to use for simulation)</div><div class="line">    -compare          (compares simulation results running once on the default GPU and once on the CPU)</div><div class="line">    -cpu              (run n-body simulation on the CPU)</div><div class="line">    -tipsy=&lt;file.bin&gt; (load a tipsy model file for simulation)</div><div class="line"></div><div class="line">NOTE: The CUDA Samples are not meant for performance measurements. Results may vary when GPU Boost is enabled.</div><div class="line"></div><div class="line">&gt; Windowed mode</div><div class="line">&gt; Simulation data stored in video memory</div><div class="line">&gt; Single precision floating point simulation</div><div class="line">&gt; 1 Devices used for simulation</div><div class="line">gpuDeviceInit() CUDA Device [0]: &quot;GeForce GTX 1080</div><div class="line">&gt; Compute 6.1 CUDA device: [GeForce GTX 1080]</div><div class="line">number of bodies = 256000</div><div class="line">256000 bodies, total time for 10 iterations: 2395.682 ms</div><div class="line">= 273.559 billion interactions per second</div><div class="line">= 5471.177 single-precision GFLOP/s at 20 flops per interaction</div></pre></td></tr></table></figure>
<p>至此CUDA8.0安装完成。</p>
<h2 id="三、安装cuDNN-v5-1"><a href="#三、安装cuDNN-v5-1" class="headerlink" title="三、安装cuDNN v5.1"></a>三、安装cuDNN v5.1</h2><p>先去Nvidia开发者网站下载<a href="https://developer.nvidia.com/rdp/cudnn-download" target="_blank" rel="external">cuDNN</a>，这个需要注册账号后才能下载。<br>选择Download cuDNN v5.1 (August 10, 2016), for CUDA 8.0，然后点cuDNN v5.1 Library for Linux，会下载一个.tgz的文件<br><img src="/images/2017-03-15-机器学习系统环境配置指南——GTX 1080+Ubuntu16.04+CUDA8+cuDNN5.1+TensorFlow/14895840227754.png" alt=""></p>
<p>在文件所在目录下执行：<code>tar -zxvf cudnn-8.0-linux-x64-v5.0-ga.tgz</code><br>虽然官方没有提供安装说明，但是google下就能查到。执行下列命令<br><code>sudo cp cuda/include/cudnn.h /usr/local/cuda/include/</code><br><code>sudo cp cuda/lib64/libcudnn* /usr/local/cuda/lib64/</code><br><code>sudo chmod a+r /usr/local/cuda/include/cudnn.h</code><br><code>sudo chmod a+r /usr/local/cuda/lib64/libcudnn*</code><br>这样cuDNN v5.1就安装完成了。</p>
<h2 id="四、安装TensorFlow"><a href="#四、安装TensorFlow" class="headerlink" title="四、安装TensorFlow"></a>四、安装TensorFlow</h2><p>TensorFlow有自己的<a href="https://www.tensorflow.org/get_started/os_setup#pip-installation" target="_blank" rel="external">官方安装文档</a>，提供了多种安装方式，我使用过其中的两种：pip安装和源码编译安装。简单说下两种安装方式的特点，pip安装过程便捷，几句命令就搞定。源码编译安装过程复杂，并且容易遇到各种问题。所以一般我们都会选择pip安装方式。<br>安装过程还有些小插曲，第一次安装的时候先尝试了使用pip安装，结果安装完后TensorFlow不识别GPU，捣鼓了很久并且google各种资料安装过程都没有问题，遂放弃pip转为源码编译安装成功了。过了几天重做了系统，又要安装TensorFlow，这次抱着试一试的心态使用pip安装，结果成功了= =然而并不知道为什么，所以第二次也就没用源码安装了。</p>
<p>本机安装环境为Python2.7，安装的TensorFlow版本为 v0.12.0 RC1</p>
<h3 id="1、pip安装"><a href="#1、pip安装" class="headerlink" title="1、pip安装"></a>1、pip安装</h3><p>首先安装pip<br><code>sudo apt-get install python-pip python-dev</code><br>如果使用的是Python3则换成pip3</p>
<p>安装TensorFlow<br><code>sudo pip install tensorflow</code></p>
<p>安装TensorFlow的GPU版本<br><code>sudo pip install tensorflow-gpu</code></p>
<p>OK，完成！是不是超简单= =哈哈，下面说下注意事项<br>如果网速不好的话可以在GitHub上先下载好<a href="https://github.com/tensorflow/tensorflow" target="_blank" rel="external">TensorFlow的安装包</a>，然后进行本地安装，当然还是会联网下一些依赖包，但是都比较小<br>在安装包目录下执行<br><code>sudo pip install tensorflow-0.12.0rc1-cp27-none-linux_x86_64.whl</code><br><code>sudo pip install tensorflow_gpu-0.12.0rc1-cp27-none-linux_x86_64.whl</code><br>install后面那部分就是下载的安装包的文件名</p>
<h3 id="2、源码编译安装"><a href="#2、源码编译安装" class="headerlink" title="2、源码编译安装"></a>2、源码编译安装</h3><p>首先先安装相关依赖包<br><code>sudo apt-get install python-pip</code><br><code>sudo apt-get install python-numpy swig python-dev python-wheel</code></p>
<p>在本地编译TensorFlow源码的话需要使用Google开源的一个构建工具——Bazel，也有<a href="http://www.bazel.io/versions/master/docs/install.html" target="_blank" rel="external">官方安装文档</a><br>首先需要下载Bazel，推荐<a href="https://github.com/bazelbuild/bazel/releases" target="_blank" rel="external">去GitHub上下载</a>，下载对应版本的安装包installer-linux-x86_64.sh。之前下载的是0.3.0版本的，结果在配置TensorFlow的时候出了一堆问题，后来换成了0.4.2版本问题解决。所以推荐下载最新版本的<br>在Bazel安装包所在目录下执行<br><code>sudo chmod +x bazel-0.4.2-installer-linux-x86_64.sh</code><br><code>sudo ./bazel-0.4.2-installer-linux-x86_64.sh --user</code><br>需要注意的是Bazel需要Java环境，如果没有的话需要安装，直接使用apt-get安装即可<br><code>sudo apt-get update</code><br><code>sudo apt-get install default-jre</code><br><code>sudo apt-get install default-jdk</code><br>安装完成后再执行<code>sudo ./bazel-0.4.2-installer-linux-x86_64.sh --user</code>即可</p>
<p>然后在 ~/.bashrc中追加：</p>
<blockquote>
<p>source /home/gai/.bazel/bin/bazel-complete.bash<br>export PATH=$PATH:/home/gai/.bazel/bin</p>
</blockquote>
<p>需要注意的是，把gai换成自己系统的用户名<br>至于为什么要追加这个内容，我在Bazel安装文档中找到以下内容</p>
<blockquote>
<p>Bazel comes with a bash completion script. To install it:</p>
<ul>
<li>Build it with Bazel: bazel build //scripts:bazel-complete.bash.</li>
<li>Copy the script bazel-bin/scripts/bazel-complete.bash to your completion folder (/etc/bash_completion.d directory under Ubuntu). If you don’t have a completion folder, you can copy it wherever suits you and simply insert source /path/to/bazel-complete.bash in your ~/.bashrc file (under OS X, put it in your ~/.bash_profile file).</li>
</ul>
</blockquote>
<p>我在使用源码编译安装的时候直接在~/.bashrc追加了那两行内容，没有做Bazel安装文档中步骤。等下次使用源码编译安装的时候再尝试下</p>
<p>在~/.bashrc追加完后执行<code>source ~/.bashrc</code>更新一下</p>
<p>至此Bazel安装完成，下一步开始编译TensorFlow</p>
<p>首先先下载TensorFlow源码，可以使用git 命令从GitHub上克隆下来：git clone <a href="https://github.com/tensorflow/tensorflow" target="_blank" rel="external">https://github.com/tensorflow/tensorflow</a> ，这是最新版，也可以自己<a href="https://github.com/tensorflow/tensorflow" target="_blank" rel="external">去GitHub上下载</a>release版，推荐后者<br>下载完成后进入TensorFlow主目录，执行：<br><code>./configure</code><br>开始配置TensorFlow，接下来会有一系列问题需要确认，我印象中会询问是否需要支持Google Cloud、Hadoop、OpenCL、CUDA等，其中CUDA是我们需要的，所以我除了CUDA选了yes以外其他的都选了no<br>如果配置成功的话会出现下列信息，可能不完全一样，但至少会有Configuration finished</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">INFO: Starting clean (this may take a while). Consider using --expunge_async if the clean takes more than several minutes.</div><div class="line">.....</div><div class="line">____Loading package: tensorflow/contrib/util</div><div class="line">____Loading package: tensorflow/tools/test</div><div class="line">____Downloading http://bazel-mirror.storage.googleapis.com/github.com/google/protobuf/archive/008b5a228b37c054f46ba478ccafa5e855cb16db.tar.gz: 97,938 bytes</div><div class="line">____Downloading http://bazel-mirror.storage.googleapis.com/github.com/google/protobuf/archive/008b5a228b37c054f46ba478ccafa5e855cb16db.tar.gz: 451,148 bytes</div><div class="line">____Downloading http://bazel-mirror.storage.googleapis.com/github.com/google/protobuf/archive/008b5a228b37c054f46ba478ccafa5e855cb16db.tar.gz: 802,540 bytes</div><div class="line">____Downloading http://bazel-mirror.storage.googleapis.com/github.com/google/protobuf/archive/008b5a228b37c054f46ba478ccafa5e855cb16db.tar.gz: 1,317,340 bytes</div><div class="line">____Downloading http://bazel-mirror.storage.googleapis.com/github.com/google/protobuf/archive/008b5a228b37c054f46ba478ccafa5e855cb16db.tar.gz: 2,055,608 bytes</div><div class="line">____Downloading http://bazel-mirror.storage.googleapis.com/github.com/google/protobuf/archive/008b5a228b37c054f46ba478ccafa5e855cb16db.tar.gz: 2,247,228 bytes</div><div class="line">____Downloading http://bazel-mirror.storage.googleapis.com/github.com/google/protobuf/archive/008b5a228b37c054f46ba478ccafa5e855cb16db.tar.gz: 2,328,350 bytes</div><div class="line">____Downloading http://bazel-mirror.storage.googleapis.com/github.com/google/protobuf/archive/008b5a228b37c054f46ba478ccafa5e855cb16db.tar.gz: 2,457,050 bytes</div><div class="line">____Downloading http://bazel-mirror.storage.googleapis.com/github.com/google/protobuf/archive/008b5a228b37c054f46ba478ccafa5e855cb16db.tar.gz: 2,585,750 bytes</div><div class="line">____Downloading http://bazel-mirror.storage.googleapis.com/github.com/google/protobuf/archive/008b5a228b37c054f46ba478ccafa5e855cb16db.tar.gz: 3,518,110 bytes</div><div class="line">____Downloading http://bazel-mirror.storage.googleapis.com/github.com/google/protobuf/archive/008b5a228b37c054f46ba478ccafa5e855cb16db.tar.gz: 3,711,160 bytes</div><div class="line">INFO: All external dependencies fetched successfully.</div><div class="line">Configuration finished</div></pre></td></tr></table></figure>
<p>然后使用Bazel来编译TensorFlow，在TensorFlow源码目录下执行以下命令<br><code>bazel build -c opt --config=cuda //tensorflow/cc:tutorials_example_trainer</code><br>编译需要一段时间，配置为i7-6700+24G内存大约耗时20分钟<br>编译完成后会显示以下信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Target //tensorflow/cc:tutorials_example_trainer up-to-date:</div><div class="line">  bazel-bin/tensorflow/cc/tutorials_example_trainer</div><div class="line">INFO: Elapsed time: 1196.829s, Critical Path: 986.68s</div></pre></td></tr></table></figure>
<p>执行一下TensorFlow官方提供的例子，看看能否成功调用GPU<br><code>bazel-bin/tensorflow/cc/tutorials_example_trainer --use_gpu</code><br>如果看到<strong>successfully opened CUDA library、Creating TensorFlow device (/gpu:0)、显卡信息以及下面的运算过程</strong>，那说明成功调用了GPU</p>
<p>下面将TensorFlow源码编译成pip安装包供Python使用<br>编译CPU版本<br><code>bazel build -c opt //tensorflow/tools/pip_package:build_pip_package</code><br>如果要编译GPU版本的，不用执行上一句，只需执行以下命令<br><code>bazel build -c opt --config=cuda //tensorflow/tools/pip_package:build_pip_package</code><br>然后执行<br><code>bazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/tensorflow_pkg</code><br><code>sudo pip install /tmp/tensorflow_pkg/tensorflow-0.12.0rc1-cp27-cp27mu-linux_x86_64.whl</code></p>
<p>安装完成~</p>
<h3 id="3、测试TensorFlow"><a href="#3、测试TensorFlow" class="headerlink" title="3、测试TensorFlow"></a>3、测试TensorFlow</h3><p>下面测试下TensorFlow是否安装成功，并且是否能调用GPU<br>首先先配置环境变量，在home目录下执行<br><code>sudo gedit .bash_profile</code><br>然后在里面添加下面两行内容</p>
<blockquote>
<p>export LD_LIBRARY_PATH=”$LD_LIBRARY_PATH:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64”<br>export CUDA_HOME=/usr/local/cuda</p>
</blockquote>
<p>然后执行：<code>source ~/.bash_profile</code>更新一下<br>执行下列代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">$ python</div><div class="line">...</div><div class="line">&gt;&gt;&gt; import tensorflow as tf</div><div class="line">I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcublas.so locally</div><div class="line">I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcudnn.so locally</div><div class="line">I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcufft.so locally</div><div class="line">I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcuda.so.1 locally</div><div class="line">I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcurand.so locally</div><div class="line">&gt;&gt;&gt; hello = tf.constant(&apos;Hello, TensorFlow!&apos;)</div><div class="line">&gt;&gt;&gt; sess = tf.Session()</div><div class="line">I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero</div><div class="line">I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 0 with properties: </div><div class="line">name: GeForce GTX 1080</div><div class="line">major: 6 minor: 1 memoryClockRate (GHz) 1.8095</div><div class="line">pciBusID 0000:01:00.0</div><div class="line">Total memory: 7.92GiB</div><div class="line">Free memory: 6.47GiB</div><div class="line">I tensorflow/core/common_runtime/gpu/gpu_device.cc:906] DMA: 0 </div><div class="line">I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 0: Y </div><div class="line">I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -&gt; (device: 0, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)</div><div class="line">&gt;&gt;&gt; print(sess.run(hello))</div><div class="line">Hello, TensorFlow!</div><div class="line">&gt;&gt;&gt; a = tf.constant(10)</div><div class="line">&gt;&gt;&gt; b = tf.constant(32)</div><div class="line">&gt;&gt;&gt; print(sess.run(a + b))</div><div class="line">42</div><div class="line">&gt;&gt;&gt;</div></pre></td></tr></table></figure>
<p>首先import tensorflow没出错并且能输出<strong>Hello, TensorFlow!</strong>和<strong>42</strong>，这表明TensorFlow是可以使用的<br>然后看到<strong>successfully opened CUDA library</strong>和<strong>Creating TensorFlow device (/gpu:0)以及显卡信息</strong>，这表明是能够调用GPU<br>此外如何使用GPU以及是否使用了GPU可以<a href="https://www.tensorflow.org/how_tos/using_gpu/" target="_blank" rel="external">参考这篇内容</a></p>
<p>还可以测试一个TensorFlow的neural net model<br>执行：<code>python /usr/local/lib/python2.7/dist-packages/tensorflow/models/image/mnist/convolutional.py</code><br>第一次执行会下载一些东西然后开始执行。我的电脑执行的时间大约是40s</p>
<h3 id="4、注意事项"><a href="#4、注意事项" class="headerlink" title="4、注意事项"></a>4、注意事项</h3><ul>
<li>如果采用pip安装TensorFlow并要启用GPU支持的话，tensorflow和tensorflow-gpu都要安装，并且顺序不可以错。如果卸载了tensorflow，保留了tensorflow-gpu，此时TensorFlow是不好用的，并且在有tensorflow-gpu的情况下再装tensorflow，这时候TensorFlow是无法识别GPU的。所以如果要卸载那么把tensorflow和tensorflow-gpu都卸载，然后再按照先tensorflow后tensorflow-gpu的顺序安装。</li>
<li>如果采用源码编译安装TensorFlow并要启用GPU支持的话，直接编译GPU版本的pip安装包然后安装即可。</li>
<li>采用源码编译安装TensorFlow，在进行TensorFlow配置时，如果系统中没有安装OpenCL而在Do you wish to build TensorFlow with OpenCL support? [y/N]时又选择了y，那么会出现”Invalid SYCL 1.2 library path. /usr/local/computecpp/lib/libComputeCpp.so cannot be found “这个错误。</li>
<li>当初使用Bazel 0.3.0版本，进行TensorFlow配置时出现的错误如下。解决办法是使用了Bazel最新版0.4.2（在Bazel0.3.0时还使用过该命令tensorflow$ git pull –recurse-submodules，然后后来换成的0.4.2，不知是否有影响 ）<br>这个错误当初参考了以下信息<a href="https://github.com/tensorflow/tensorflow/issues/4365" target="_blank" rel="external">https://github.com/tensorflow/tensorflow/issues/4365</a> 、<a href="https://github.com/tensorflow/tensorflow/issues/5357" target="_blank" rel="external">https://github.com/tensorflow/tensorflow/issues/5357</a> 、<a href="https://github.com/tensorflow/tensorflow/issues/4319" target="_blank" rel="external">https://github.com/tensorflow/tensorflow/issues/4319</a></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line">INFO: Starting clean (this may take a while). Consider using --expunge_async if the clean takes more than several minutes.</div><div class="line">.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:17:3: //external:eigen_archive: no such attribute &apos;urls&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:17:3: //external:eigen_archive: missing value for mandatory attribute &apos;url&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:28:3: //external:libxsmm_archive: no such attribute &apos;urls&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:28:3: //external:libxsmm_archive: missing value for mandatory attribute &apos;url&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:44:3: //external:com_googlesource_code_re2: no such attribute &apos;urls&apos; in &apos;http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:44:3: //external:com_googlesource_code_re2: missing value for mandatory attribute &apos;url&apos; in &apos;http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:54:3: //external:gemmlowp: no such attribute &apos;urls&apos; in &apos;http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:54:3: //external:gemmlowp: missing value for mandatory attribute &apos;url&apos; in &apos;http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:64:3: //external:farmhash_archive: no such attribute &apos;urls&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:64:3: //external:farmhash_archive: missing value for mandatory attribute &apos;url&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:80:3: //external:highwayhash: no such attribute &apos;urls&apos; in &apos;http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:80:3: //external:highwayhash: missing value for mandatory attribute &apos;url&apos; in &apos;http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:90:3: //external:nasm: no such attribute &apos;urls&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:90:3: //external:nasm: missing value for mandatory attribute &apos;url&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:101:3: //external:jpeg: no such attribute &apos;urls&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:101:3: //external:jpeg: missing value for mandatory attribute &apos;url&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:112:3: //external:png_archive: no such attribute &apos;urls&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:112:3: //external:png_archive: missing value for mandatory attribute &apos;url&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:123:3: //external:gif_archive: no such attribute &apos;urls&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:123:3: //external:gif_archive: missing value for mandatory attribute &apos;url&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:135:3: //external:six_archive: no such attribute &apos;urls&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:135:3: //external:six_archive: missing value for mandatory attribute &apos;url&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:151:3: //external:protobuf: no such attribute &apos;urls&apos; in &apos;http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:151:3: //external:protobuf: missing value for mandatory attribute &apos;url&apos; in &apos;http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:161:3: //external:gmock_archive: no such attribute &apos;urls&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:161:3: //external:gmock_archive: missing value for mandatory attribute &apos;url&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:187:3: //external:pcre: no such attribute &apos;urls&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:187:3: //external:pcre: missing value for mandatory attribute &apos;url&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:198:3: //external:swig: no such attribute &apos;urls&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:198:3: //external:swig: missing value for mandatory attribute &apos;url&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:222:3: //external:grpc: no such attribute &apos;urls&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:222:3: //external:grpc: missing value for mandatory attribute &apos;url&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:245:3: //external:linenoise: no such attribute &apos;urls&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:245:3: //external:linenoise: missing value for mandatory attribute &apos;url&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:258:3: //external:llvm: no such attribute &apos;urls&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:258:3: //external:llvm: missing value for mandatory attribute &apos;url&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:269:3: //external:jsoncpp_git: no such attribute &apos;urls&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:269:3: //external:jsoncpp_git: missing value for mandatory attribute &apos;url&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:285:3: //external:boringssl: no such attribute &apos;urls&apos; in &apos;http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:285:3: //external:boringssl: missing value for mandatory attribute &apos;url&apos; in &apos;http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:295:3: //external:nanopb_git: no such attribute &apos;urls&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:295:3: //external:nanopb_git: missing value for mandatory attribute &apos;url&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:311:3: //external:zlib_archive: no such attribute &apos;urls&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: /home/gai/tensorflow/tensorflow/workspace.bzl:311:3: //external:zlib_archive: missing value for mandatory attribute &apos;url&apos; in &apos;new_http_archive&apos; rule.</div><div class="line">ERROR: com.google.devtools.build.lib.packages.BuildFileContainsErrorsException: error loading package &apos;&apos;: Encountered error while reading extension file &apos;cuda/build_defs.bzl&apos;: no such package &apos;@local_config_cuda//cuda&apos;: error loading package &apos;external&apos;: Could not load //external package.</div><div class="line">ERROR: missing fetch expression. Type &apos;bazel help fetch&apos; for syntax and help.</div></pre></td></tr></table></figure>
<ul>
<li>使用GPU执行TensorFlow时可能会出现以下内容，对实际运行没看出来有什么影响</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">E tensorflow/core/framework/op_kernel.cc:925] OpKernel (&apos;op: &quot;NegTrain&quot; device_type: &quot;CPU&quot;&apos;) for unknown op: NegTrain</div><div class="line">E tensorflow/core/framework/op_kernel.cc:925] OpKernel (&apos;op: &quot;Skipgram&quot; device_type: &quot;CPU&quot;&apos;) for unknown op: Skipgram</div></pre></td></tr></table></figure>
<h2 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h2><p><a href="http://www.52nlp.cn/深度学习主机环境配置-ubuntu-16-04-nvidia-gtx-1080-cuda-8" target="_blank" rel="external">深度学习主机环境配置: Ubuntu16.04+Nvidia GTX 1080+CUDA8.0</a><br><a href="http://www.52nlp.cn/深度学习主机环境配置-ubuntu16-04-geforce-gtx1080-tensorflow" target="_blank" rel="external">深度学习主机环境配置: Ubuntu16.04+GeForce GTX 1080+TensorFlow</a><br><a href="http://www.cnblogs.com/yiruparadise/p/5671620.html" target="_blank" rel="external">ubuntu14.04 安装 tensorflow</a><br><a href="https://alliseesolutions.wordpress.com/2016/09/08/install-gpu-tensorflow-from-sources-w-ubuntu-16-04-and-cuda-8-0-rc/" target="_blank" rel="external">Install GPU TensorFlow From Sources w/ Ubuntu 16.04 and Cuda 8.0</a><br><a href="http://darren1231.pixnet.net/blog/post/331300298-安裝-tensorflow-教學-gpu%3Anvidia1070(from-source" target="_blank" rel="external">安裝 tensorflow 教學 GPU:Nvidia1070(from source)</a>)</p>
<h4 id="课外小知识"><a href="#课外小知识" class="headerlink" title="课外小知识"></a>课外小知识</h4><p>为什么使用Bazel来编译TensorFlow，他们是什么关系？<br>Bazel是一个构建工具（构建工具：依据文件之间的依赖关系来决定文件编译的顺序），类似于Linux下的make命令。Bazel的出现是Google为了解决自己的问题：Google所有的源代码都在一个源代码仓库，而Google是一个跨国公司，世界各地的程序员都需要下载代码然后编译，所以在项目的构建过程中，性能问题是最关键的需求。<br>Bazel相对于其他的构建工具相比，更加强调结构化和速度。<br><img src="/images/2017-03-15-机器学习系统环境配置指南——GTX 1080+Ubuntu16.04+CUDA8+cuDNN5.1+TensorFlow/14895848606250.png" alt=""></p>
<p>在Bazel中文件编译顺序的自由度很高。构建过程可以用这样的二分图来表示。在一次构建过程中并发度越高（即二分图宽度越宽），执行时间就越短，如果机器足够多，那么一次构建的时间就主要由二分图的高度来决定。所以便可以在许多机器上执行分布式并发构建。<br>通过这个二分图可以看出，Bazel还具有增量构建的特点。当只有小部分源代码更改的时候，只需构建相应的部分即可。<br>构建行为具有函数式特点，即输入是相同的则输出也是相同的。依据这个特点，来缓存和复用构建结果。<br>Bazel和TensorFlow师出同门都来自于Google，在Google内部编译都使用Bazel，所以TensorFlow的编译过程自然也使用Bazel啦。<br>想进一步了解Bazel的同学可以看看以下内容：<br>Google开发Bazel的背景知识<br><a href="http://google-engtools.blogspot.co.uk/2011/06/build-in-cloud-accessing-source-code.html" target="_blank" rel="external">http://google-engtools.blogspot.co.uk/2011/06/build-in-cloud-accessing-source-code.html</a><br><a href="http://google-engtools.blogspot.tw/2011/08/build-in-cloud-how-build-system-works.html" target="_blank" rel="external">http://google-engtools.blogspot.tw/2011/08/build-in-cloud-how-build-system-works.html</a><br><a href="http://google-engtools.blogspot.jp/2011/09/build-in-cloud-distributing-build-steps.html" target="_blank" rel="external">http://google-engtools.blogspot.jp/2011/09/build-in-cloud-distributing-build-steps.html</a><br><a href="http://google-engtools.blogspot.tw/2011/10/build-in-cloud-distributing-build.html" target="_blank" rel="external">http://google-engtools.blogspot.tw/2011/10/build-in-cloud-distributing-build.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://bluesmilery.github.io/blogs/9a018dfc/" data-id="cj0hsu9mt0002mhmvvma2p048" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/blogs/481fe3af/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Récent</strong>
      <div class="article-nav-title">
        
          Reinforcement learning part 1 - Introduction
        
      </div>
    </a>
  
  
    <a href="/blogs/1509af3a/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Ancien</strong>
      <div class="article-nav-title">Linux系统安装——Ubuntu16.04+Windows7双系统</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Mot-clés</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/增强学习RL/">增强学习RL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/机器学习ML/">机器学习ML</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Nuage de mot-clés</h3>
    <div class="widget tagcloud">
      <a href="/tags/增强学习RL/" style="font-size: 10px;">增强学习RL</a> <a href="/tags/机器学习ML/" style="font-size: 10px;">机器学习ML</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Articles récents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/blogs/18a3f212/">Machine learning part 1 - Linear Regression</a>
          </li>
        
          <li>
            <a href="/blogs/481fe3af/">Reinforcement learning part 1 - Introduction</a>
          </li>
        
          <li>
            <a href="/blogs/9a018dfc/">机器学习系统环境配置指南 —— GTX 1080 + Ubuntu16.04 + CUDA8 + cuDNN5.1 + TensorFlow</a>
          </li>
        
          <li>
            <a href="/blogs/1509af3a/">Linux系统安装——Ubuntu16.04+Windows7双系统</a>
          </li>
        
          <li>
            <a href="/blogs/4a17b156/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Gai<br>
      Propulsé by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>